<link rel="stylesheet" type="text/css" href="<?php echo base_url() ?>assets/css/select2.min.css">
<script src="<?php echo base_url() ?>assets/sweetalert/sweetalert.min.js"></script>
<style>
	.size-204 {
		width: calc(100% - 105px);
	}

	.css-7k2jum {
		position: relative;
		display: inline-block;
		vertical-align: top;
	}

	.css-7k2jum > div {
		width: 180px;
		margin: 0px 12px 12px 0px;
	}

	.css-10wy6qd {
		display: flex;
		position: relative;
		flex: 0 0 216px;
		height: 70px;
		margin: 8px;
		filter: drop-shadow(rgba(0, 0, 0, 0.12) 0px 1px 3px);
		box-sizing: border-box;
		width: 190px;
	}

	.css-10wy6qd > div {
		background-color: rgb(255, 255, 255);
	}

	.css-17w967y {
		position: relative;
	}

	.css-10wy6qd * {
		box-sizing: border-box;
	}

	.css-10wy6qd > div {
		background-color: rgb(255, 255, 255);
	}

	.css-7yj588 {
		flex: 1 1 100px;
		padding: 8px 0px 8px 8px;
		white-space: nowrap;
		min-width: 108px;
		cursor: pointer;
	}

	.css-10wy6qd * {
		box-sizing: border-box;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-19gt17v-unf-heading-unf-heading {
		display: block;
		position: relative;
		font-weight: 400;
		font-size: 0.857143rem;
		line-height: 18px;
		color: var(--color-text-high,rgba(49,53,59,0.96));
		text-decoration: initial;
		margin: 0px;
		text-transform: capitalize;
	}

	.css-10wy6qd * {
		box-sizing: border-box;
	}

	.css-whbpyf {
		margin-top: 0px;
		margin-bottom: 2px;
		color: rgba(0, 0, 0, 0.7);
		font-size: 18px;
		font-weight: 800;
		line-height: 1.43;
		overflow: hidden;
		text-overflow: ellipsis;
	}

	.css-10wy6qd * {
		box-sizing: border-box;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-uswdof {
		margin-top: 0px;
		margin-bottom: 0px;
		font-size: 9px;
		line-height: 1.5;
		color: rgba(0, 0, 0, 0.38);
	}

	.css-10wy6qd * {
		box-sizing: border-box;
	}

	.css-10wy6qd > div {
		background-color: rgb(255, 255, 255);
	}

	.css-1fgyps7 {
		flex: 0 0 66px;
		display: flex;
		width: 125px;
		background-image: url('https://assets.tokopedia.net/assets-tokopedia-lite/v2/zeus/kratos/c0c8b6b0.svg');
		background-repeat-y: no-repeat;
		background-size: 160% 70px;
	}

	.css-10wy6qd * {
		box-sizing: border-box;
	}

	.css-10wy6qd > div {
		background-color: rgb(255, 255, 255);
	}

	.css-dlnyqv {
		position: relative;
	}

	.css-10wy6qd * {
		box-sizing: border-box;
	}

	.glyphicon {
		font-size: 30px;
	}

	.css-zeq6c8 {
		margin: 0px 0px 10px;
		color: var(--N700,#31353B);
		line-height: 60px;
		font-size: 60px;
		font-weight: 400;
	}

	.css-zeq6c8 > span {
		margin-left: 5px;
		color: var(--N400,#6C727C);
		line-height: 22px;
		font-size: 16px;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-ddjk3l {
		display: block;
		position: relative;
		font-weight: 800;
		font-family: "Nunito Sans", -apple-system, sans-serif;
		text-decoration: initial;
		font-size: 1.14286rem;
		line-height: 22px;
		color: var(--N700,rgba(49,53,59,0.96));
		margin: 0px;
		text-transform: uppercase;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-1s46cvt {
		font-size: 1rem;
		font-weight: 400;
		text-transform: none;
		margin-top: 10px;
		line-height: 22px;
	}

	.css-pcuskv {
		display: block;
		position: relative;
		font-weight: 800;
		font-family: "Nunito Sans", -apple-system, sans-serif;
		text-decoration: initial;
		font-size: 0.85714rem;
		line-height: 18px;
		color: var(--N700,rgba(49,53,59,0.68));
		margin: 32px 0px 16px;
		text-transform: uppercase;
	}

	.css-1jetg87 {
		padding: 24px 0px;
		border-bottom: 1px solid var(--N75,#E5E7E9);
	}

	.css-l4kq1m {
		display: flex;
		flex-wrap: nowrap;
		align-items: flex-start;
	}

	.css-7smpge {
		display: flex;
		flex-wrap: nowrap;
		height: auto;
		margin: 0px;
		width: 20%;
	}

	.css-53duzp {
		flex-shrink: 0;
		align-self: center;
		width: 48px;
		height: 48px;
		min-width: 0px;
		margin-left: 0px;
		border-left: none;
	}

	.css-snjfsc {
		position: relative;
		display: inline-block;
		width: 48px;
		height: 48px;
		border-radius: 50%;
		background-color: var(--N0,#FFFFFF);
		cursor: inherit;
		overflow: hidden;
	}

	.css-1ew46s1-unf-img {
		width: 100%;
		border-radius: 4px;
		height: 100%;
		display: flex;
		background-image: none;
	}

	.css-1nxyhqh {
		width: 100%;
		height: 100%;
		object-fit: cover;
		border-radius: 4px;
	}

	.css-3efjn4 {
		flex-shrink: 1;
		align-self: center;
		min-width: 0px;
		padding: 0px 0px 0px 16px;
		margin-left: 0px;
		border-left: none;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-xige44-unf-link {
		color: var(--G500,#03AC0E);
		font-size: 0.857143rem;
		text-decoration: none;
		cursor: pointer;
		font-weight: 700;
		overflow-wrap: break-word;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-1og4tm6-unf-heading-unf-heading {
		display: block;
		position: relative;
		font-weight: 400;
		font-size: 0.857143rem;
		line-height: 18px;
		color: var(--color-text-disabled,rgba(49,53,59,0.32));
		text-decoration: initial;
		margin: 0px;
	}

	.css-17gqcdy {
		width: 60%;
	}

	.css-xhl5yf {
		display: inline-block;
		vertical-align: middle;
		width: 76px;
		height: 12px;
		margin: 0px;
		background: url(https://assets.tokopedia.net/assets-tokopedia-lite/v2/zeus/kratos/4ed9ea8f.svg) left center / contain no-repeat, url(https://assets.tokopedia.net/assets-tokopedia-lite/v2/zeus/kratos/4ed9ea8f.svg) 16px center no-repeat, url(https://assets.tokopedia.net/assets-tokopedia-lite/v2/zeus/kratos/4ed9ea8f.svg) 32px center no-repeat, url(https://assets.tokopedia.net/assets-tokopedia-lite/v2/zeus/kratos/4ed9ea8f.svg) 48px center no-repeat, url(https://assets.tokopedia.net/assets-tokopedia-lite/v2/zeus/kratos/4ed9ea8f.svg) 64px center no-repeat;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-s4w7lz-unf-heading-unf-heading {
		display: block;
		position: relative;
		font-weight: 400;
		font-size: 1rem;
		line-height: 20px;
		color: var(--color-text-low,rgba(49,53,59,0.68));
		text-decoration: initial;
		margin: 3px 0px 0px;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-c9o9wb {
		padding: 12px 16px 12px 8px;
		margin-top: 16px;
		border-radius: 16px;
		background-color: var(--N50,#F3F4F5);
	}

	.css-drikti {
		display: flex;
		flex-wrap: nowrap;
		height: auto;
		margin: 0px;
	}

	.css-jk7iwj {
		flex-shrink: 0;
		width: 32px;
		min-width: 0px;
		padding: 4px 0px 0px;
		margin-left: 0px;
		border-left: none;
	}

	.css-nny01h > div, .css-nny01h > div:hover {
		box-shadow: rgb(49 53 59 / 12%) 0px 1px 2px 0px;
	}

	.css-1hy3mwi {
		position: relative;
		display: inline-block;
		width: 32px;
		height: 32px;
		border-radius: 50%;
		background-color: var(--N0,#FFFFFF);
		cursor: inherit;
		overflow: hidden;
	}

	.css-1ew46s1-unf-img {
		width: 100%;
		border-radius: 4px;
		height: 100%;
		display: flex;
		background-image: none;
	}

	.css-1nxyhqh {
		width: 100%;
		height: 100%;
		object-fit: cover;
		border-radius: 4px;
	}

	.css-1p0pkw3 {
		flex-shrink: 1;
		min-width: 0px;
		padding: 0px 0px 0px 12px;
		margin-left: 0px;
		border-left: none;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-nny01h > div, .css-nny01h > div:hover {
		box-shadow: rgb(49 53 59 / 12%) 0px 1px 2px 0px;
	}

	.css-mh4tan-unf-label {
		position: relative;
		display: inline-flex;
		-webkit-box-align: center;
		align-items: center;
		font-weight: 700;
		border-radius: 3px;
		line-height: 16px;
		padding: 0px 8px;
		height: 20px;
		font-size: 0.714286rem;
		background-color: var(--G200,#D6FFDE);
		color: var(--G500,#03AC0E);
		margin: 0px;
		overflow: initial;
		-webkit-box-pack: center;
		justify-content: center;
		transition: all 280ms ease-out 0s;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-1og4tm6-unf-heading-unf-heading {
		display: block;
		position: relative;
		font-weight: 400;
		font-size: 0.857143rem;
		line-height: 18px;
		color: var(--color-text-disabled,rgba(49,53,59,0.32));
		text-decoration: initial;
		margin: 0px;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.css-3lpl5n a, .css-3lpl5n p, .css-3lpl5n span, .css-3lpl5n li {
		font-family: "open sans", tahoma, sans-serif;
	}

	.stars-outer {
	display: inline-block;
	position: relative;
	font-family: FontAwesome;
	}

	.stars-outer::before {
	content: "\f006 \f006 \f006 \f006 \f006";
	}

	.stars-inner {
	position: absolute;
	top: 0;
	left: 0;
	white-space: nowrap;
	overflow: hidden;
	width: 0;
	}

	.stars-inner::before {
	content: "\f005 \f005 \f005 \f005 \f005";
	color: #f8ce0b;
	}

	.stars-inner2 {
	position: absolute;
	top: 0;
	left: 0;
	white-space: nowrap;
	overflow: hidden;
	width: 0;
	}

	.stars-inner2::before {
	content: "\f005 \f005 \f005 \f005 \f005";
	color: #f8ce0b;
	}

	.attribution {
	font-size: 12px;
	color: #444;
	text-decoration: none;
	text-align: center;
	position: fixed;
	right: 10px;
	bottom: 10px;
	z-index: -1;
	}
	.attribution:hover {
	color: #1fa67a;
	}
</style>	
<div class="single-sec">
	<div class="container">
		<ol class="breadcrumb">
			<li><a href="<?= base_url('user/Home') ?>">Home</a></li>
			<li class="active">Detail Produk</li>
		</ol>
		<!-- start content -->
		<div class="col-md-12 det" style="margin-bottom: 80px;">
			<div class="single_left">
				<div class="grid images_3_of_2">
					<ul id="etalage">
						<li style="width: 300px;">
							<a href="">
								<?php if ($detail_produk[0]['foto_produk1'] == null) : ?>

								<?php else : ?>
									<img class="etalage_thumb_image" style="width:300px;" src="<?= base_url() ?>assets/img/produk_penjual/<?= $detail_produk[0]['foto_produk1'] ?>" class="img-responsive" />
									<img class="etalage_source_image" style="width:300px;" src="<?= base_url() ?>assets/img/produk_penjual/<?= $detail_produk[0]['foto_produk1'] ?>" class="img-responsive" title="" />
								<?php endif; ?>
							</a>
						</li>
						<li style="width: 300px;">
							<?php if ($detail_produk[0]['foto_produk2'] == null) : ?>

							<?php else : ?>
								<img class="etalage_thumb_image" style="width: contain; height: 250px; object-fit: cover;" src="<?= base_url() ?>assets/img/produk_penjual/<?= $detail_produk[0]['foto_produk2'] ?>" class="img-responsive" />
								<img class="etalage_source_image" style="width:300px;" src="<?= base_url() ?>assets/img/produk_penjual/<?= $detail_produk[0]['foto_produk2'] ?>" class="img-responsive" title="" />
							<?php endif; ?>
						<li style="width: 300px;">
							<?php if ($detail_produk[0]['foto_produk3'] == null) : ?>

							<?php else : ?>
								<img class="etalage_thumb_image" style="width: contain; height: 250px; object-fit: cover;" src="<?= base_url() ?>assets/img/produk_penjual/<?= $detail_produk[0]['foto_produk3'] ?>" class="img-responsive" />
								<img class="etalage_source_image" style="width: contain; height: 250px; object-fit: cover;" src="<?= base_url() ?>assets/img/produk_penjual/<?= $detail_produk[0]['foto_produk3'] ?>" class="img-responsive" title="" />
							<?php endif; ?>
						</li>
					</ul>
					<div class="clearfix"></div>
				</div>
			</div>
			<div class="single-right">
				<h3><?= $detail_produk[0]['nama_produk'] ?></h3>
				<div class="id">
					<h4>ID: <?= $detail_produk[0]['id_produk'] ?></h4>
					<h4>Berat Bersih: <?php echo $detail_produk[0]['berat_bersih'] ?> gram</h4>
					<?php if ($detail_produk[0]['jumlah_stok'] > 0) : ?>
						<h4>Stok: <?php echo $detail_produk[0]['jumlah_stok'] ?> items</h4>
					<?php else : ?>
						<h4>Stok: 0 items</h4>
					<?php endif; ?>
				</div>
				<div class="cost" style="margin-top: 20px;">
					<div class="prdt-cost">
						<ul>
							<li>
								<h4>Harga</h4>
							</li>
							<li class="active">Rp. <span id="harga_jual"></span> </li>
							<li>
								<h4>Subtotal </h4>
							</li>
							<li class="active">Rp. <span id="subtotal"></span> </li>
							<!-- <form method="POST" action="<?= base_url() ?>user/Home/keranjang_belanja"> -->
							<form id="formAksi">
								<input type="hidden" value="1" name="quantity">
								<input type="hidden" name="harga" >
								<input type="hidden" name="harga_jumlah" >
								<input type="hidden" name="harga_term" >
								<input type="hidden" name="potongan" >
								<input type="hidden" name="id_produk" value="<?php echo $detail_produk[0]['id_produk'] ?>">
								<input type="hidden" name="jumlah_stok" value="<?php echo $detail_produk[0]['jumlah_stok'] ?>">
								<input type="hidden" name="berat_kotor" value="<?php echo $detail_produk[0]['berat_kotor'] ?>">
								<input type="hidden" name="ip_number" value="<?php echo $this->session->userdata('id_kpesan'); ?>">
								<div style="display: flex;">
									<button type="button" id="minus_jumlah" class="btn btn-success pull-left" style="padding: 2px 5px 0;"><i class="fa fa-minus fa-fw"></i></button>
									<input required="" type="text" class="form-control col-md" id="jumlah_beli" name="jumlah_beli" style="width: 50px; margin: 0 5px; height: 28px; padding: 0 8px; text-align: center; border-radius: 6px;" value="1">
									<button type="button" id="plus_jumlah" class="btn btn-success pull-left" style="padding: 2px 5px 0"><i class="fa fa-plus fa-fw"></i></button>
								</div>
								<br />
								<?php foreach($voucher as $v){?>
								<div class="css-7k2jum" data-testid="PDPDetailVoucher[0]" onclick="cek_voucher(<?php echo $v->id?>)">
									<div class="css-10wy6qd" id="merchant-voucher-ANNVPM24" data-testid="MerchantVoucher">
										<div class="css-17w967y">
											
										</div>
										<div class="css-7yj588">
											<p data-unify="Typography" class="css-19gt17v-unf-heading-unf-heading e1qvo2ff8" data-testid="MerchantVoucherType"></p>
											<h2 class="css-whbpyf" data-testid="MerchantVoucherValue"><?php echo 'Rp '.number_format($v->nominal)?></h2>
											<p class="css-uswdof">min. Pembelian <strong data-testid="MerchantVoucherMinSpend"><?php echo $v->keterangan_syarat?></strong></p>
										</div>
										<div class="css-1fgyps7 e1qur15t0"></div>
										<div class="css-dlnyqv"></div>
									</div>
								</div>
								<?php } ?>
								<br />
								<?php if ($detail_produk[0]['jumlah_stok'] <= 0) : ?>
									<button type="submit" disabled>Maaf produk sudah habis</button>
								<?php else : ?>
									<button type="button" id="btn_save" onclick="save()">Tambah ke keranjang</button>
								<?php endif; ?>
							</form>
						</ul>
					</div>

					<div class="clearfix"></div>
				</div>
				<div class="single-bottom1">
					<h6>Details</h6>
					<p class="prod-desc"><?= $detail_produk[0]['deskripsi'] ?></p>
					
				</div>
			</div>
			<div class="clearfix"></div>
			<hr />
			<h2 data-testid="sumTotalReview" class="css-ddjk3l">
				Ulasan(<?php echo $rating->jml_ulasan?>)<br>
				<p class="css-1s46cvt"><?= $detail_produk[0]['nama_produk'] ?></p>
			</h2>	
			<h5 class="css-zeq6c8" data-testid="txtRatingScore"><?php echo number_format($rating->total_ulasan/$rating->jml_ulasan, 1)?><span>/5</span></h5>
			<!-- <div id="stars-existing" class="starrr glyphicon-3x" data-rating='<?php echo number_format($rating->total_ulasan/$rating->jml_ulasan, 0)?>' style="color: yellow;" disabled></div> -->
			<div class="hotel_a">
			<div class="stars-outer">
				<div class="stars-inner"></div>
			</div>
			</div>
			<h2 class="css-pcuskv" data-testid="lblAllReview">Semua Ulasan (<?php echo $rating->jml_ulasan?>)</h2>
			<?php foreach ($query as $u){?>
			<div class="css-1jetg87">
				<div class="css-l4kq1m">
					<div data-testid="pdpFlexWrapperContainer" class="css-7smpge e1ufc1ph1">
						<div class="css-53duzp e1ufc1ph0">
							<div class="css-snjfsc eaj5cj71">
								<picture class="css-1ew46s1-unf-img e11hknjr0">
								<img src="https://accounts.tokopedia.com/image/v1/u/16297369/user_thumbnail/desktop" alt="Ellen" data-unify="Image" class="css-1nxyhqh e11hknjr1">
								</picture>
							</div>
						</div>
						<div class="css-3efjn4 e1ufc1ph0">
							<a data-unify="Link" font-size="12" class="css-xige44-unf-link en8iawh0" data-testid="txtCustFullNameFilter0"><?php echo $u->nama_review?></a>
						</div>
					</div>
					<div class="css-17gqcdy">
					<div class="komen_<?php echo $u->id_review?>">
					<div class="stars-outer">
						<div class="stars-inner2"></div>
					</div>
					</div>
						<p data-unify="Typography" data-testid="txtReviewFilter0" class="css-s4w7lz-unf-heading-unf-heading e1qvo2ff8" style="overflow-wrap: break-word;">
							<span><?php echo $u->komentar?></span>
						</p>
					</div>
				</div>
				
			</div>
			<?php }?>
			<div class="col-md-9">
					<div class="blog-page__content">
						<?php echo @$data;?>
					<div class="page__pagination">
						<?php echo $halaman;?>
					</div>
					</div>
				</div>
		</div>
	</div>
	<div class="clearfix"></div>
</div>
</div>

<script>
	var link = "<?php echo site_url('user/home')?>";
	var id_produk = "<?php echo $detail_produk[0]['id_produk'] ?>";
	function swal_berhasil() { swal("Ditambahkan ke keranjang !", "success"); }
    function swal_berhasil_delet() { swal("Barang Berhasil Di Hapus !", "success"); }
	function swal_gagal_voucher() { swal("Nominal Kurang Dari Harga Yang Ditentukan !"); }
    function swal_berhasil_update() { swal("keranjang Belanja Telah Di Perbaharui !", "success"); }
    function swal_error(msg) { swal({ title:"ERROR", text: msg, type: "warning", closeOnConfirm: true});  }

	$(document).ready(function(){    
        detail_stok();
		edit(id_produk);

		const ratings = {
		hotel_a : '<?php echo number_format($rating->total_ulasan/$rating->jml_ulasan, 1)?>',
		};

		// total number of stars
		const starTotal = 5;

		for(const rating in ratings) {  
		const starPercentage = (ratings[rating] / starTotal) * 100;
		const starPercentageRounded = `${(Math.round(starPercentage / 10) * 10)}%`;
		document.querySelector(`.${rating} .stars-inner`).style.width = starPercentageRounded; 
		}

		const ratings2 = {
		<?php foreach ($query as $u){?>	
			komen_<?php echo $u->id_review ?> : '<?php echo number_format($u->rate_star, 1)?>',
		<?php } ?>
		};

		const starTotal2 = 5;

		for(const rating2 in ratings2) {  
		const starPercentage2 = (ratings2[rating2] / starTotal2) * 100;
		const starPercentageRounded2 = `${(Math.round(starPercentage2 / 10) * 10)}%`;
		document.querySelector(`.${rating2} .stars-inner2`).style.width = starPercentageRounded2; 
		}
    });

	function detail_stok(){
        $('#stok').load("<?php echo base_url();?>user/home/load_stok/<?php echo $detail_produk[0]['id_produk'] ?>");
    }

	function save() {
            $('#btn_save').text('Saving...');
            $('#btn_save').attr('disabled', true);

            var url;
            url = link+"/keranjang_belanja";
            
            //tinyMCE.triggerSave();
            $.ajax({
                url: url,
                type: "POST",
                data: $('#formAksi').serialize(),
                dataType: "JSON",
                success: function(result) {
                    
                    swal_berhasil();
                    cek(); 
                    detail_stok(); 
                        //detail_cart(); 
                      
                }, error: function(jqXHR, textStatus, errorThrown) {
                    //var div = document.getElementById('detail_cart');
                     setTimeout(function(){
                        $('#btn_save').text('Tambah Ke Keranjang');
                        $('#btn_save').attr('disabled', false);
                       // document.getElementById('formAksi').reset();
                     }, 1000);
                     swal_berhasil(); 
                     //div.innerHTML='';
                     cek();
                     detail_stok(); 
                }
            });



    }

	function edit(id) {
			
			$.ajax({
				url : link+"/ajax_get_id/"+id,
				type: "GET",
				dataType: "JSON",
				success: function(result) {  
					
					$('[name="harga"]').val(result.harga);
					$('[name="harga_jumlah"]').val(result.harga);
					$('[name="harga_term"]').val(result.harga);
					$('#harga_jual').html(to_rupiah(result.harga));
					$('#subtotal').html(to_rupiah(result.harga));

				}, error: function (jqXHR, textStatus, errorThrown) {
					alert('Error get data from ajax');
				}
			});
	}

	$(document).on('click', '#plus_jumlah', function() {
		let input = $(this).parent().find('#jumlah_beli');
		let jumlah_stok = $('[name="jumlah_stok"]').val();
		//let max = $(this).parent().parent().parent().find('#stok_min').val();

		if(Number(input.val()) < Number(jumlah_stok)) {
			input.val(Number(input.val()) + 1);
			let it = $(this).parent().parent().parent().parent().parent().parent();
			console.log('input', it);
			jumlahChange(it);
		};
	});

	$(document).on('click', '#minus_jumlah', function() {
		let input = $(this).parent().find('#jumlah_beli');
		//if(Number(input.val()) > 1) {
			input.val(Number(input.val()) - 1);
			let it = $(this).parent().parent().parent().parent().parent().parent();
			jumlahChange(it);
		//};
	});

	function jumlahChange(it){
		var jumlah_beli = $('#jumlah_beli').val();
		var harga = $('[name="harga"]').val();

		var jumlah = jumlah_beli * harga;

		$('[name="harga_jumlah"]').val(jumlah);
		$('[name="harga_term"]').val(jumlah);
		$('#subtotal').html(to_rupiah(jumlah));
	}	

	function cek_voucher(id){
		var harga_jumlah = $('[name="harga_jumlah"]').val();
		var harga_term = $('[name="harga_term"]').val();
		$.ajax({
				url : link+"/ajax_get_voucher/"+id,
				type: "GET",
				dataType: "JSON",
				success: function(result) {  
					
					if(harga_term <= result.nominal_syarat){
						swal_gagal_voucher();
					}else{
						let jumlah_promo = harga_jumlah - result.nominal;
						let jumlah_promo_text = harga_term - result.nominal;
						let hargaText =  to_rupiah(jumlah_promo_text) +"<strike  style='font-size: 8pt'>" + to_rupiah(harga_term) + "</strike>";
						$('[name="harga_jumlah"]').val(jumlah_promo);
						$('[name="potongan"]').val(result.nominal);
						$('#subtotal').html(hargaText);
					}

					

				}, error: function (jqXHR, textStatus, errorThrown) {
					alert('Error get data from ajax');
				}
		});
	}

	function to_rupiah(angka){
		var rev     = parseInt(angka, 10).toString().split('').reverse().join('');
		var rev2    = '';
		for(var i = 0; i < rev.length; i++){
			rev2  += rev[i];
			if((i + 1) % 3 === 0 && i !== (rev.length - 1)){
				rev2 += '.';
			}
		}
		return rev2.split('').reverse().join('') + ',-';
	}

	
</script>	